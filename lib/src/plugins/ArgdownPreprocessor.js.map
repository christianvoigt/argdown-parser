{"version":3,"sources":["../../../src/plugins/ArgdownPreprocessor.js"],"names":["_","RelationObjectTypes","Object","freeze","STATEMENT","Symbol","RECONSTRUCTED_ARGUMENT","SKETCHED_ARGUMENT","ArgdownPreprocessor","data","relations","relation","fromType","getElementType","from","toType","to","status","argument","index","indexOf","splice","conclusionStatement","pcs","length","equivalenceClass","statements","title","push","arguments","obj","name","$","statementReferencePattern","statementDefinitionPattern","statementMentionPattern","argumentReferencePattern","argumentDefinitionPattern","argumentMentionPattern","linkPattern","uniqueTitleCounter","getUniqueTitle","getEquivalenceClass","ec","currentStatement","currentStatementOrArgument","currentArgument","currentArgumentReconstruction","currentInference","rangesStack","parentsStack","currentRelation","inStatementTree","onArgdownEntry","onStatementEntry","node","parentNode","isRootOfStatementTree","isChildOfStatementTree","statement","onStatementExit","members","isUsedAsRootOfStatementTree","isUsedAsChildOfStatementTree","onStatementDefinitionEntry","match","exec","image","onStatementReferenceEntry","onStatementMentionExit","trailingWhitespace","range","type","start","text","stop","ranges","updateArgument","onArgumentDefinitionEntry","descriptions","onArgumentDefinitionOrReferenceExit","onArgumentReferenceEntry","onArgumentMentionExit","onFreestyleTextEntry","children","child","onLinkEntry","linkRange","url","onBoldEntry","boldRange","onBoldExit","boldEnd","last","pop","onItalicEntry","italicRange","onItalicExit","italicEnd","onRelationExit","contentNode","content","target","getRelationTarget","relationExists","existingRelation","onIncomingSupportEntry","onIncomingAttackEntry","onOutgoingSupportEntry","onOutgoingAttackEntry","onContradictionEntry","onRelationsEntry","statementOrArgument","onRelationsExit","onArgumentEntry","childIndex","precedingSibling","Emptyline","onArgumentExit","onArgumentStatementExit","statementNode","role","isUsedAsConclusion","inference","isUsedAsPremise","statementNr","onInferenceEntry","inferenceRules","metaData","onInferenceRulesExit","trim","onMetadataStatementExit","key","value","i","onHeadingExit","headingStart","heading","argdownListeners","argdownEntry","headingExit","statementEntry","statementExit","argumentEntry","argumentExist","argumentStatementExit","inferenceEntry","inferenceRulesExit","metadataStatementExit","StatementDefinitionEntry","StatementReferenceEntry","StatementMentionExit","ArgumentDefinitionEntry","ArgumentReferenceEntry","ArgumentMentionExit","argumentDefinitionExit","argumentReferenceExit","incomingSupportEntry","incomingSupportExit","incomingAttackEntry","incomingAttackExit","outgoingSupportEntry","outgoingSupportExit","outgoingAttackEntry","outgoingAttackExit","contradictionEntry","contradictionExit","relationsEntry","relationsExist","freestyleTextEntry","italicEntry","italicExit","boldEntry","boldExit","LinkEntry","keys","statementKey","console","log","argumentKey","module","exports"],"mappings":"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","file":"ArgdownPreprocessor.js","sourcesContent":["import * as _ from 'lodash';\nimport {Statement} from '../model/Statement.js';\nimport {Argument} from '../model/Argument.js';\nimport {EquivalenceClass} from '../model/EquivalenceClass.js';\nimport {tokenMatcher} from 'chevrotain';\nimport {ArgdownLexer} from './../ArgdownLexer.js';\n\nconst RelationObjectTypes = Object.freeze({STATEMENT: Symbol(\"STATEMENT\"), RECONSTRUCTED_ARGUMENT: Symbol(\"RECONSTRUCTED ARGUMENT\"), SKETCHED_ARGUMENT: Symbol(\"SKETCHED ARGUMENT\")});\n\nclass ArgdownPreprocessor{\n  run(data){\n    for(let relation of this.relations){\n      let fromType = this.getElementType(relation.from);\n      let toType = this.getElementType(relation.to);\n      if(fromType == RelationObjectTypes.SKETCHED_ARGUMENT ||toType == RelationObjectTypes.RECONSTRUCTED_ARGUMENT ||toType == RelationObjectTypes.SKETCHED_ARGUMENT){\n        relation.status = \"sketched\";\n      }else if(fromType == RelationObjectTypes.STATEMENT ||fromType == RelationObjectTypes.RECONSTRUCTED_ARGUMENT){\n        relation.status = \"reconstructed\";\n        if(fromType == RelationObjectTypes.RECONSTRUCTED_ARGUMENT){\n          //change relation.from to point to the argument's conclusion\n          let argument = relation.from;\n          let index = _.indexOf(argument.relations, relation);\n          argument.relations.splice(index, 1);\n\n          let conclusionStatement = argument.pcs[relation.from.pcs.length - 1];\n          let equivalenceClass = this.statements[conclusionStatement.title];\n          relation.from = equivalenceClass;\n          equivalenceClass.relations.push(relation);\n        }\n      }\n    }\n\n\n    data.relations = this.relations;\n    data.statements = this.statements;\n    data.arguments = this.arguments;\n    return data;\n  }\n  getElementType(obj){\n    if(obj instanceof Argument){\n      if(obj.pcs && obj.pcs.length > 0){\n        return RelationObjectTypes.RECONSTRUCTED_ARGUMENT;\n      }else{\n        return RelationObjectTypes.SKETCHED_ARGUMENT;\n      }\n    }else if(obj instanceof EquivalenceClass){\n        return RelationObjectTypes.STATEMENT;\n    }\n    return null;\n  }\n  constructor(){\n    this.name = \"ArgdownPreprocessor\";\n    let $ = this;\n\n    const statementReferencePattern = /\\[(.+)\\]/;\n    const statementDefinitionPattern = /\\[(.+)\\]\\:/;\n    const statementMentionPattern = /\\@\\[(.+)\\](\\s?)/;\n    const argumentReferencePattern = /\\<(.+)\\>/;\n    const argumentDefinitionPattern = /\\<(.+)\\>\\:/;\n    const argumentMentionPattern = /\\@\\<(.+)\\>(\\s?)/;\n    const linkPattern = /\\[(.+)\\]\\((.+)\\)/;\n\n    let uniqueTitleCounter = 0;\n    function getUniqueTitle(){\n      uniqueTitleCounter++;\n      return \"Untitled \"+uniqueTitleCounter;\n    }\n    function getEquivalenceClass(title){\n      if(!title)\n        return null;\n\n      let ec = $.statements[title];\n      if(!ec){\n        ec = new EquivalenceClass();\n        ec.title = title;\n        $.statements[title] = ec;\n      }\n      return ec;\n    }\n\n\n    let currentStatement = null;\n    let currentStatementOrArgument = null;\n    let currentArgument = null;\n    let currentArgumentReconstruction = null;\n    let currentInference = null;\n    let rangesStack = [];\n    let parentsStack = [];\n    let currentRelation = null;\n    let inStatementTree = false;\n\n    function onArgdownEntry(){\n      $.statements = {};\n      $.arguments = {};\n      $.relations = [];\n      currentStatement = null;\n      currentStatementOrArgument = null;\n      currentArgumentReconstruction = null;\n      currentInference = null;\n      currentArgument = null;\n      rangesStack = [];\n      parentsStack = [];\n      currentRelation = null;\n      inStatementTree = false;\n    }\n    function onStatementEntry(node, parentNode){\n      currentStatement = new Statement();\n      if(parentNode.name == 'argdown'){\n          currentStatement.isRootOfStatementTree = true;\n          inStatementTree = true;\n      }else if(inStatementTree){\n        currentStatement.isChildOfStatementTree = true;\n      }\n      currentStatementOrArgument = currentStatement;\n      node.statement = currentStatement;\n    }\n    function onStatementExit(node){\n      let statement = node.statement;\n      if(!statement.title || statement.title == ''){\n        statement.title = getUniqueTitle();\n      }\n      if(statement.isRootOfStatementTree){\n        inStatementTree = false;\n      }\n      let equivalenceClass = getEquivalenceClass(statement.title);\n      equivalenceClass.members.push(statement);\n      if(statement.isRootOfStatementTree){\n        equivalenceClass.isUsedAsRootOfStatementTree = true; //members are used outside of argument reconstructions (not as premise or conclusion)\n      }else if(statement.isChildOfStatementTree){\n        equivalenceClass.isUsedAsChildOfStatementTree = true;\n      }\n      currentStatement = null;\n    }\n    function onStatementDefinitionEntry(node){\n      let match = statementDefinitionPattern.exec(node.image);\n      if(match != null){\n        currentStatement.title = match[1];\n        node.statement = currentStatement;\n      }\n    }\n    function onStatementReferenceEntry(node){\n      let match = statementReferencePattern.exec(node.image);\n      if(match != null){\n        currentStatement.title = match[1];\n        node.statement = currentStatement;\n      }\n    }\n    function onStatementMentionExit(node){\n      let match = statementMentionPattern.exec(node.image);\n      if(match){\n        node.title = match[1];\n        if(node.image[node.image.length - 1] == \" \"){\n          node.trailingWhitespace = ' ';\n        }else {\n          node.trailingWhitespace = '';\n        }\n        if(currentStatement){\n          let range = {type:'statement-mention',title:node.title, start:currentStatement.text.length};\n          currentStatement.text += node.image;\n          range.stop = currentStatement.text.length -1;\n          currentStatement.ranges.push(range);\n        }\n      }\n    }\n    function updateArgument(title){\n      currentArgument = $.arguments[title];\n      if(!currentArgument){\n        currentArgument = new Argument();\n        if(!title){\n          currentArgument.title = getUniqueTitle();\n        }else {\n          currentArgument.title = title;\n        }\n        //we are in the ArgumentDefinition token, parentNode is the argumentDefinition rule\n        $.arguments[currentArgument.title] = currentArgument;\n      }\n      currentStatementOrArgument = currentArgument;\n    }\n    function onArgumentDefinitionEntry(node, parentNode){\n      let match = argumentDefinitionPattern.exec(node.image);\n      if(match != null){\n        let title = match[1];\n        updateArgument(title);\n        currentStatement = new Statement();\n        currentArgument.descriptions.push(currentStatement);\n        parentNode.argument = currentArgument;\n      }\n    }\n    function onArgumentDefinitionOrReferenceExit(){\n      currentStatement = null;\n      currentArgument = null;\n    }\n    function onArgumentReferenceEntry(node, parentNode){\n      let match = argumentReferencePattern.exec(node.image);\n      if(match != null){\n        let title = match[1];\n        updateArgument(title);\n        parentNode.argument = currentArgument;\n      }\n    }\n    function onArgumentMentionExit(node){\n      let match = argumentMentionPattern.exec(node.image);\n      if(match){\n        node.title = match[1];\n        if(node.image[node.image.length - 1] == \" \"){\n          node.trailingWhitespace = ' ';\n        }else {\n          node.trailingWhitespace = '';\n        }\n        if(currentStatement){\n          let range = {type:'argument-mention',title:node.title, start:currentStatement.text.length};\n          currentStatement.text += node.image;\n          range.stop = currentStatement.text.length -1;\n          currentStatement.ranges.push(range);\n        }\n      }\n    }\n    function onFreestyleTextEntry(node){\n      node.text = \"\";\n      for(let child of node.children){\n        node.text += child.image;\n      }\n      if(currentStatement)\n        currentStatement.text += node.text;\n    }\n    function onLinkEntry(node){\n      let match = linkPattern.exec(node.image);\n      let linkRange = {type:'link', start: currentStatement.text.length};\n      node.url = match[2];\n      node.text = match[1];\n      currentStatement.text += node.text;\n      linkRange.stop = currentStatement.text.length - 1;\n      linkRange.url = node.url;\n      currentStatement.ranges.push(linkRange);\n      if(node.image[node.image.length - 1] == ' '){\n        currentStatement.text += ' ';\n        node.trailingWhitespace = ' ';\n      }else{\n        node.trailingWhitespace = '';\n      }\n    }\n\n    function onBoldEntry(){\n      let boldRange = {type:'bold', start: currentStatement.text.length};\n      rangesStack.push(boldRange);\n      currentStatement.ranges.push(boldRange);\n    }\n    function onBoldExit(node){\n      let boldEnd = _.last(node.children);\n      if(boldEnd.image[boldEnd.image.length - 1] == ' '){\n        currentStatement.text += ' ';\n        node.trailingWhitespace = ' ';\n      }else{\n        node.trailingWhitespace = '';\n      }\n      let range = _.last(rangesStack);\n      range.stop = currentStatement.text.length - 1;\n      rangesStack.pop();\n    }\n    function onItalicEntry(){\n      let italicRange = {type:'italic', start: currentStatement.text.length};\n      rangesStack.push(italicRange);\n      currentStatement.ranges.push(italicRange);\n    }\n    function onItalicExit(node){\n      let italicEnd = _.last(node.children);\n      if(italicEnd.image[italicEnd.image.length - 1] == ' '){\n        currentStatement.text += ' ';\n        node.trailingWhitespace = ' ';\n      }else{\n        node.trailingWhitespace = '';\n      }\n      let range = _.last(rangesStack);\n      range.stop = currentStatement.text.length - 1;\n      rangesStack.pop();\n    }\n\n    function onRelationExit(node){\n      let relation = node.relation;\n      let contentNode = node.children[1];\n      let content = contentNode.argument ||contentNode.statement;\n      let target = getRelationTarget(content);\n      if(relation){\n        if(relation.from)\n          relation.to = target;\n        else {\n          relation.from = target;\n        }\n\n        let relationExists = false;\n        for(let existingRelation of relation.from.relations){\n          if(relation.to == existingRelation.to && relation.type == existingRelation.type){\n            relationExists = true;\n            break;\n          }\n        }\n\n        if(!relationExists){\n          $.relations.push(relation);\n          relation.from.relations.push(relation);\n          relation.to.relations.push(relation);\n        }\n      }\n    }\n    function onIncomingSupportEntry(node){\n      let target = _.last(parentsStack);\n      currentRelation = {type:\"support\", from:target};\n      node.relation = currentRelation;\n    }\n    function onIncomingAttackEntry(node){\n      let target = _.last(parentsStack);\n      currentRelation = {type:\"attack\", from:target};\n      node.relation = currentRelation;\n    }\n    function onOutgoingSupportEntry(node){\n      let target = _.last(parentsStack);\n      currentRelation = {type:\"support\", to:target};\n      node.relation = currentRelation;\n    }\n    function onOutgoingAttackEntry(node){\n      let target = _.last(parentsStack);\n      currentRelation = {type:\"attack\", to:target};\n      node.relation = currentRelation;\n    }\n    function onContradictionEntry(node){\n      let target = _.last(parentsStack);\n      currentRelation = {type:\"contradiction\", from:target};\n      node.relation = currentRelation;\n    }\n\n    function onRelationsEntry(){\n      parentsStack.push(getRelationTarget(currentStatementOrArgument));\n    }\n    function getRelationTarget(statementOrArgument){\n      let target = statementOrArgument;\n      if(statementOrArgument instanceof Statement){\n        if(!statementOrArgument.title)\n          statementOrArgument.title = getUniqueTitle();\n        target = getEquivalenceClass(statementOrArgument.title);\n      }\n      return target;\n    }\n    function onRelationsExit(){\n      currentRelation = null;\n      parentsStack.pop();\n    }\n\n    function onArgumentEntry(node, parentNode, childIndex){\n      let argument = null;\n      if(childIndex > 0){\n          let precedingSibling = parentNode.children[childIndex - 1];\n          if(precedingSibling.name == 'argumentReference' || precedingSibling.name == 'argumentDefinition'){\n            argument = precedingSibling.argument;\n          }else if(tokenMatcher(precedingSibling, ArgdownLexer.Emptyline)){\n            precedingSibling = parentNode.children[childIndex - 2];\n            if(precedingSibling.name == 'argumentReference' || precedingSibling.name == 'argumentDefinition'){\n              argument = precedingSibling.argument;\n            }\n          }\n        }\n        if(!argument){\n          updateArgument();\n        }\n        //if there is a previous reconstruction, overwrite it\n        if(argument.pcs.length > 0){\n          //TODO: throw error\n          argument.pcs = [];\n        }\n        node.argument = argument;\n        currentArgumentReconstruction = argument;\n    }\n    function onArgumentExit(){\n      currentStatement = null;\n      currentArgument = null;\n      currentArgumentReconstruction = null;\n    }\n    function onArgumentStatementExit(node, parentNode, childIndex){\n      if(node.children.length > 1){\n        //first node is ArgdownLexer.ArgumentStatementStart\n        let statementNode = node.children[1];\n        let statement = statementNode.statement;\n        let ec = getEquivalenceClass(statement.title);\n        statement.role = \"premise\";\n        if(childIndex > 0){\n          let precedingSibling = parentNode.children[childIndex - 1];\n          if(precedingSibling.name == 'inference'){\n            statement.role = \"conclusion\";\n            ec.isUsedAsConclusion = true;\n            statement.inference = precedingSibling.inference;\n          }\n        }\n        if(statement.role == \"premise\"){\n          ec.isUsedAsPremise = true;\n        }\n        currentArgumentReconstruction.pcs.push(statement);\n        node.statement = statement;\n        node.statementNr = currentArgumentReconstruction.pcs.length;\n      }\n    }\n    function onInferenceEntry(node){\n      currentInference = {inferenceRules:[], metaData:{}};\n      node.inference = currentInference;\n    }\n    function onInferenceRulesExit(node){\n      for(let child of node.children){\n        if(child.name == 'freestyleText'){\n          currentInference.inferenceRules.push(child.text.trim());\n        }\n      }\n    }\n    function onMetadataStatementExit(node){\n      let key = node.children[0].text;\n      let value = null;\n      if(node.children.length == 2){\n        value = node.children[1].text;\n      }else{\n        value = [];\n        for(let i = 1; i < node.children.length; i++){\n          value.push(node.children[i].text);\n        }\n      }\n      currentInference.metaData[key] = value;\n    }\n    function onHeadingExit(node){\n      let headingStart = node.children[0];\n      node.heading = headingStart.image.length;\n      node.text = node.children[1].text;\n    }\n\n    this.argdownListeners = {\n      argdownEntry : onArgdownEntry,\n      headingExit : onHeadingExit,\n      statementEntry : onStatementEntry,\n      statementExit : onStatementExit,\n      argumentEntry : onArgumentEntry,\n      argumentExist : onArgumentExit,\n      argumentStatementExit : onArgumentStatementExit,\n      inferenceEntry : onInferenceEntry,\n      inferenceRulesExit : onInferenceRulesExit,\n      metadataStatementExit : onMetadataStatementExit,\n      StatementDefinitionEntry : onStatementDefinitionEntry,\n      StatementReferenceEntry : onStatementReferenceEntry,\n      StatementMentionExit : onStatementMentionExit,\n      ArgumentDefinitionEntry : onArgumentDefinitionEntry,\n      ArgumentReferenceEntry : onArgumentReferenceEntry,\n      ArgumentMentionExit : onArgumentMentionExit,\n      argumentDefinitionExit : onArgumentDefinitionOrReferenceExit,\n      argumentReferenceExit : onArgumentDefinitionOrReferenceExit,\n      incomingSupportEntry : onIncomingSupportEntry,\n      incomingSupportExit : onRelationExit,\n      incomingAttackEntry : onIncomingAttackEntry,\n      incomingAttackExit : onRelationExit,\n      outgoingSupportEntry : onOutgoingSupportEntry,\n      outgoingSupportExit : onRelationExit,\n      outgoingAttackEntry : onOutgoingAttackEntry,\n      outgoingAttackExit : onRelationExit,\n      contradictionEntry : onContradictionEntry,\n      contradictionExit : onRelationExit,\n      relationsEntry : onRelationsEntry,\n      relationsExist : onRelationsExit,\n      freestyleTextEntry : onFreestyleTextEntry,\n      italicEntry : onItalicEntry,\n      italicExit : onItalicExit,\n      boldEntry : onBoldEntry,\n      boldExit : onBoldExit,\n      LinkEntry : onLinkEntry\n    }\n  }\n  logRelations(data){\n    for(let statementKey of Object.keys(data.statements)){\n      let statement = data.statements[statementKey];\n      for(let relation of statement.relations){\n        if(relation.from == statement){\n          console.log(\"Relation from: \"+relation.from.title+\" to: \"+relation.to.title+\" type: \"+relation.type);\n        }\n      }\n    }\n    for(let argumentKey of Object.keys(data.arguments)){\n      let argument = data.arguments[argumentKey];\n      for(let relation of argument.relations){\n        if(relation.from == argument){\n          console.log(\"Relation from: \"+relation.from.title+\" to: \"+relation.to.title+\" type: \"+relation.type);\n        }\n      }\n    }\n  }\n}\nmodule.exports = {\n  ArgdownPreprocessor: ArgdownPreprocessor,\n  RelationObjectTypes : RelationObjectTypes\n}\n"]}